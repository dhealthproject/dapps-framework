<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>QueryService | @dhealthdapps/backend</title><meta name="description" content="Documentation for @dhealthdapps/backend"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">@dhealthdapps/backend</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">@dhealthdapps/backend</a></li><li><a href="QueryService.html">QueryService</a></li></ul><h1>Class QueryService&lt;TDocument, TModel&gt; </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><dl class="tsd-comment-tags"><dt>description</dt><dd><p>Abstraction layer for queries setup using the Mongo
service. This class contains methods to validate, process and
format database queries.
<br /><br />
Native field values <em>will</em> be casted to their Typescript equivalent
depending on the field value in Mongo, i.e. <code>&quot;true&quot;</code> becomes <code>true</code>.
<br /><br />
Also, arrays are <em>always</em> passed to the <code>$in</code> routine, currently no
other operations are possible with array and objects.
<br /><br />
Note that you must pass a <em>document class</em> to the generic <code>TDocument</code>
template of this class, e.g. QueryService<StateDocument>.
<br /><br /></p>
</dd><dt>example</dt><dd><p>Inject and use the QueryService in another class</p>
<pre><code class="language-typescript"><span class="hl-1"> </span><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-3">QueryService</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-4">&quot;./QueryService&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-1"> @</span><span class="hl-11">Injectable</span><span class="hl-1">()</span><br/><span class="hl-1"> </span><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-0">class</span><span class="hl-1"> </span><span class="hl-7">ExampleService</span><span class="hl-1"> {</span><br/><span class="hl-1">   </span><span class="hl-9">// inject QueryService</span><br/><span class="hl-1">   </span><span class="hl-0">constructor</span><span class="hl-1">(</span><br/><span class="hl-1">     @</span><span class="hl-11">InjectModel</span><span class="hl-1">(</span><span class="hl-3">Example</span><span class="hl-1">.</span><span class="hl-3">name</span><span class="hl-1">) </span><span class="hl-0">private</span><span class="hl-1"> </span><span class="hl-0">readonly</span><span class="hl-1"> </span><span class="hl-3">model</span><span class="hl-1">: </span><span class="hl-7">ExampleModel</span><span class="hl-1">,</span><br/><span class="hl-1">     </span><span class="hl-0">private</span><span class="hl-1"> </span><span class="hl-0">readonly</span><span class="hl-1"> </span><span class="hl-3">queryService</span><span class="hl-1">: </span><span class="hl-7">QueryService</span><span class="hl-1">&lt;</span><span class="hl-7">ExampleDocument</span><span class="hl-1">, </span><span class="hl-7">ExampleModel</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">   ) {}</span><br/><br/><span class="hl-1">   </span><span class="hl-9">// example usage</span><br/><span class="hl-1">   </span><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-11">findOne</span><span class="hl-1">(</span><span class="hl-3">query</span><span class="hl-1">: </span><span class="hl-7">ExampleQuery</span><span class="hl-1">): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">ExampleDocument</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">     </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-0">this</span><span class="hl-1">.</span><span class="hl-3">queryService</span><span class="hl-1">.</span><span class="hl-11">findOne</span><span class="hl-1">(</span><span class="hl-3">query</span><span class="hl-1">, </span><span class="hl-0">this</span><span class="hl-1">.</span><span class="hl-3">model</span><span class="hl-1">);</span><br/><span class="hl-1">   }</span><br/><span class="hl-1"> }</span>
</code></pre>
</dd><dt>todo</dt><dd><p>add handler abstraction logic</p>
</dd><dt>todo</dt><dd><p>Method <code>typecastField</code> does not permit <em>simple</em> arithmetical operations like <code>&lt;&gt;&lt;==&gt;</code> on numbers.</p>
</dd><dt>todo</dt><dd><p>Method <code>typecastField</code> is most likely incompatible with complex class objects, must be handled.</p>
</dd><dt>todo</dt><dd><p>Method <code>typecastField</code> <em>mixes</em> functionalities by defining the <code>$in</code> routines as a type-cast result.</p>
</dd><dt>since</dt><dd><p>v0.1.0</p>
</dd></dl></div></section><section class="tsd-panel tsd-type-parameters"><h3>Type Parameters</h3><ul class="tsd-type-parameters"><li><h4>TDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a></h4></li><li><h4>TModel<span class="tsd-signature-symbol"> extends </span><span class="tsd-signature-type">Model</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">&gt;</span> = <span class="tsd-signature-type">Model</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></section><section class="tsd-panel tsd-hierarchy"><h3>Hierarchy</h3><ul class="tsd-hierarchy"><li><span class="target">QueryService</span></li></ul></section><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Constructors</h3><ul class="tsd-index-list"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter"><a href="QueryService.html#constructor" class="tsd-kind-icon">constructor</a></li></ul></section><section class="tsd-index-section "><h3>Methods</h3><ul class="tsd-index-list"><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#aggregate" class="tsd-kind-icon">aggregate</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#count" class="tsd-kind-icon">count</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#createOrUpdate" class="tsd-kind-icon">create<wbr/>Or<wbr/>Update</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#exists" class="tsd-kind-icon">exists</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#find" class="tsd-kind-icon">find</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#findOne" class="tsd-kind-icon">find<wbr/>One</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#findWithTotal" class="tsd-kind-icon">find<wbr/>With<wbr/>Total</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><a href="QueryService.html#getAggregateFindQuery" class="tsd-kind-icon">get<wbr/>Aggregate<wbr/>Find<wbr/>Query</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><a href="QueryService.html#getQueryConfig" class="tsd-kind-icon">get<wbr/>Query<wbr/>Config</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><a href="QueryService.html#sanitizeSearchQuery" class="tsd-kind-icon">sanitize<wbr/>Search<wbr/>Query</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><a href="QueryService.html#typecastField" class="tsd-kind-icon">typecast<wbr/>Field</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><a href="QueryService.html#union" class="tsd-kind-icon">union</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#updateBatch" class="tsd-kind-icon">update<wbr/>Batch</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Constructors</h2><section class="tsd-panel tsd-member tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter"><a id="constructor" class="tsd-anchor"></a><h3 class="tsd-anchor-link">constructor<a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter"><li class="tsd-signature tsd-kind-icon">new <wbr/>Query<wbr/>Service<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="QueryService.html" class="tsd-signature-type" data-tsd-kind="Class">QueryService</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-type-parameters-title">Type Parameters</h4><ul class="tsd-type-parameters"><li><h4>TDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h4></li><li><h4>TModel<span class="tsd-signature-symbol"> extends </span><span class="tsd-signature-type">Model</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">&gt;</span> = <span class="tsd-signature-type">Model</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-symbol">{}</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul><h4 class="tsd-returns-title">Returns <a href="QueryService.html" class="tsd-signature-type" data-tsd-kind="Class">QueryService</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></section></section><section class="tsd-panel-group tsd-member-group "><h2>Methods</h2><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="aggregate" class="tsd-anchor"></a><h3 class="tsd-anchor-link">aggregate<a href="#aggregate" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">aggregate<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">PipelineStage</span><span class="tsd-signature-symbol">[]</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">Aggregate</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L611">src/common/services/QueryService.ts:611</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>This method performs an aggregate query and returns a mongo
aggregate result which consists of a collection of the provided
model&#39;s items.
<br /><br />
This method also <em>executes</em> the search query using the Mongo service
connected to handle {@param model}.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <span class="tsd-signature-type">PipelineStage</span><span class="tsd-signature-symbol">[]</span></h5></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">Aggregate</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h4><div></div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="count" class="tsd-anchor"></a><h3 class="tsd-anchor-link">count<a href="#count" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">count<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L104">src/common/services/QueryService.ts:104</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>This method executes a <em>count</em> query using the {@link model}
argument.
<br /><br />
Caution: Count queries require a considerable amount of RAM
to execute. It is preferred to use pro-active statistics with
collections that contain one document with a counter.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The number of matching documents.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="createOrUpdate" class="tsd-anchor"></a><h3 class="tsd-anchor-link">create<wbr/>Or<wbr/>Update<a href="#createOrUpdate" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">create<wbr/>Or<wbr/>Update<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span>, data<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span>, ops<span class="tsd-signature-symbol">?: </span><a href="../modules.html#MongoQueryOperations" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryOperations</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L278">src/common/services/QueryService.ts:278</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>This method updates <em>exactly one document</em> in a collection. The
query is build using <a href="QueryService.html#getQueryConfig">getQueryConfig</a> and can thereby use
any columns of the document.
<br /><br /></p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for the resulting document.</p>
</div></div></li><li><h5>data: <span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The fields or data that has to be updated (will be added to <code>$set: {}</code>).</p>
</div></div></li><li><h5>ops: <a href="../modules.html#MongoQueryOperations" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryOperations</a><span class="tsd-signature-symbol"> = {}</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The operations that must be run additionally (e.g. <code>$inc: {}</code>) (optional).</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h4><div></div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="exists" class="tsd-anchor"></a><h3 class="tsd-anchor-link">exists<a href="#exists" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">exists<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L127">src/common/services/QueryService.ts:127</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Method to query the <em>existence</em> of a document in the
collection mapped to {@link TModel}.
<br /><br />
This executes a <em>lean</em> mongoose query such that the
properties of the returned document are <em>reduced</em> to
only the <code>&quot;_id&quot;</code> field.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for matching documents.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>Whether a document exists which validates the passed query.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="find" class="tsd-anchor"></a><h3 class="tsd-anchor-link">find<a href="#find" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">find<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="PaginatedResultDTO.html" class="tsd-signature-type" data-tsd-kind="Class">PaginatedResultDTO</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L210">src/common/services/QueryService.ts:210</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Create a generic <em>search query</em> that is compatible with Mongo. The
returned {@link PaginatedResultDto} contains a <code>data</code> field and a
<code>pagination</code> field to permit multiple queries to be sequenced.
<br /><br />
This method also <em>executes</em> the search query using the Mongo service
connected to handle {@param model}.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for resulting documents.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="PaginatedResultDTO.html" class="tsd-signature-type" data-tsd-kind="Class">PaginatedResultDTO</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The matching documents after execution of the query.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="findOne" class="tsd-anchor"></a><h3 class="tsd-anchor-link">find<wbr/>One<a href="#findOne" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">find<wbr/>One<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span>, stripDocument<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L242">src/common/services/QueryService.ts:242</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Find one <code>TDocument</code> instance in the database and use
a query based on the <a href="Queryable.html">Queryable</a> class.
<br /><br /></p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for the resulting document.</p>
</div></div></li><li><h5>stripDocument: <span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol"> = false</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>Determines whether the query should be lean (strip out document properties).</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The resulting document.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="findWithTotal" class="tsd-anchor"></a><h3 class="tsd-anchor-link">find<wbr/>With<wbr/>Total<a href="#findWithTotal" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">find<wbr/>With<wbr/>Total<span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span>, ops<span class="tsd-signature-symbol">?: </span><a href="../modules.html#MongoQueryOperations" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryOperations</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="PaginatedResultDTO.html" class="tsd-signature-type" data-tsd-kind="Class">PaginatedResultDTO</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L156">src/common/services/QueryService.ts:156</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Create a generic <em>search query</em> that is compatible with Mongo. The
returned {@link PaginatedResultDto} contains a <code>data</code> field and a
<code>pagination</code> field to permit multiple queries to be sequenced.
<br /><br />
This method also <em>executes</em> the search query using the Mongo service
connected to handle {@param model}.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for resulting documents.</p>
</div></div></li><li><h5>ops: <a href="../modules.html#MongoQueryOperations" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryOperations</a><span class="tsd-signature-symbol"> = undefined</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="PaginatedResultDTO.html" class="tsd-signature-type" data-tsd-kind="Class">PaginatedResultDTO</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The matching documents after execution of the query.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><a id="getAggregateFindQuery" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span class="tsd-flag ts-flagProtected">Protected</span> get<wbr/>Aggregate<wbr/>Find<wbr/>Query<a href="#getAggregateFindQuery" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><li class="tsd-signature tsd-kind-icon">get<wbr/>Aggregate<wbr/>Find<wbr/>Query<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, unionWith<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span>, metadata<span class="tsd-signature-symbol">?: </span><a href="../modules.html#MongoRoutineCount" class="tsd-signature-type" data-tsd-kind="Type alias">MongoRoutineCount</a><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../modules.html#MongoQueryPipeline" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryPipeline</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L512">src/common/services/QueryService.ts:512</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Format the search query parameters to a Mongo compatible
aggregate search query. The resulting object can be used
to configure an executable Mongo aggregation or query.
<br /><br/>
Note that pagination parameters can be omitted with the
following defaults being used: <code>sort=&quot;_id&quot;</code>, <code>order=&quot;asc&quot;</code>,
<code>pageNumber=1</code>, <code>pageSize=20</code>.
<br /><br />
Note that this method takes <em>three generics</em> that <strong>must</strong>
extend the <a href="Documentable.html">Documentable</a> class and <strong>must</strong> also
contain a <code>collectionName</code>, e.g. in <a href="Account.html">Account</a>. Only
the <em>first</em> of these generics is <em>obligatory</em>, others can
be used when handling more complex union queries.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>protected</p>
</dd></dl></div><h4 class="tsd-type-parameters-title">Type Parameters</h4><ul class="tsd-type-parameters"><li><h4>T2ndDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-symbol">{ </span>collectionName<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span></h4></li><li><h4>T3rdDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-symbol">{ </span>collectionName<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span> = <span class="tsd-signature-type">any</span></h4></li><li><h4>T4thDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-symbol">{ </span>collectionName<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span> = <span class="tsd-signature-type">any</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> unionWith: <span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>(Optional) This parameter should contain a map of <a href="Queryable.html">Queryable</a> objects - defaults to empty union specification (no union).</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> metadata: <a href="../modules.html#MongoRoutineCount" class="tsd-signature-type" data-tsd-kind="Type alias">MongoRoutineCount</a><span class="tsd-signature-symbol">[]</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>(Optional) This parameter should contain one or more <code>$count</code> pipeline stage(s) - defaults to empty metadata.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <a href="../modules.html#MongoQueryPipeline" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryPipeline</a></h4><div><p>The resulting <em>aggregate search query</em> specification that is compatible with <em>Mongo aggregate queries</em>.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><a id="getQueryConfig" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span class="tsd-flag ts-flagProtected">Protected</span> get<wbr/>Query<wbr/>Config<a href="#getQueryConfig" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><li class="tsd-signature tsd-kind-icon">get<wbr/>Query<wbr/>Config<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TQueryDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TQueryDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../modules.html#SearchQuery" class="tsd-signature-type" data-tsd-kind="Type alias">SearchQuery</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L461">src/common/services/QueryService.ts:461</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Format the search query parameters to a Mongo compatible
documents search query. The resulting object can be used
to configure an executable Mongo aggregation or query.
<br /><br/>
Note that pagination parameters can be omitted with the
following defaults being used: <code>sort=&quot;_id&quot;</code>, <code>order=&quot;asc&quot;</code>,
<code>pageNumber=1</code>, <code>pageSize=20</code>.
<br /><br />
Note that the generic <code>TQueryDocument</code> should usually be
an object that extends <a href="Documentable.html">Documentable</a>, this is the
case for example with <a href="../modules.html#AccountDocument">AccountDocument</a> and it will
also contain a <code>collectionName</code> as defined in <a href="Account.html">Account</a>.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>protected</p>
</dd></dl></div><h4 class="tsd-type-parameters-title">Type Parameters</h4><ul class="tsd-type-parameters"><li><h4>TQueryDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TQueryDocument</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TQueryDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <a href="../modules.html#SearchQuery" class="tsd-signature-type" data-tsd-kind="Type alias">SearchQuery</a></h4><div><p>The configured <a href="../modules.html#SearchQuery">SearchQuery</a> with pagination parameters and sanitized Mongo query.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-protected"><a id="sanitizeSearchQuery" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span class="tsd-flag ts-flagProtected">Protected</span> sanitize<wbr/>Search<wbr/>Query<a href="#sanitizeSearchQuery" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-protected"><li class="tsd-signature tsd-kind-icon">sanitize<wbr/>Search<wbr/>Query<span class="tsd-signature-symbol">(</span>searchQuery<span class="tsd-signature-symbol">: </span><a href="../modules.html#UnsafeQueryConditions" class="tsd-signature-type" data-tsd-kind="Type alias">UnsafeQueryConditions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../modules.html#MongoQueryConditions" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryConditions</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L632">src/common/services/QueryService.ts:632</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>This method sanitizes a search query and returns a mongo
compatible query that can be executed and uses the correct
types for its conditions (and field values).
<br /><br />
This method can be used whenever data has been <em>read</em> from
Mongo and still has <em>string</em> typed values. Note that this
routine is not compatible with deep objects and may corrupt
typings of complex class instances.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>protected</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>searchQuery: <a href="../modules.html#UnsafeQueryConditions" class="tsd-signature-type" data-tsd-kind="Type alias">UnsafeQueryConditions</a></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>An object that contains <em>unsafe</em> (non-sanitized) query conditions.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <a href="../modules.html#MongoQueryConditions" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryConditions</a></h4><div><p>The sanitized search query, can be passed in mongoose <code>$match</code>.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-protected"><a id="typecastField" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span class="tsd-flag ts-flagProtected">Protected</span> typecast<wbr/>Field<a href="#typecastField" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-protected"><li class="tsd-signature tsd-kind-icon">typecast<wbr/>Field<span class="tsd-signature-symbol">(</span>value<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../modules.html#MongoQueryConditionValue" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryConditionValue</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L670">src/common/services/QueryService.ts:670</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>This method type-casts individual query values to <em>primitive</em>
types and creates routines for specific primitives like <code>number</code>
or <code>array</code>.
<br /><br />
Following rules apply:</p>
<ol>
<li>If it&#39;s a <strong>boolean</strong> value (&#39;true&#39;, &#39;false&#39;) convert it to boolean.</li>
<li>If it&#39;s a <strong>number</strong>, returns <code>{ $in: [+value, value] }</code> // both string and numeric values.</li>
<li>If it&#39;s an <strong>array</strong>, loop through all items and check each one with step 1, 2 and 4</li>
<li>If it&#39;s not any of the above types, it&#39;s a <strong>string</strong>. Returns original value.
<br /><br />
Note that objects or complex class instances cannot currently
be type-cast using this method.</li>
</ol>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>protected</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>value: <span class="tsd-signature-type">any</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>A field value that needs to be type-casted to a primitive or using a routine.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <a href="../modules.html#MongoQueryConditionValue" class="tsd-signature-type" data-tsd-kind="Type alias">MongoQueryConditionValue</a></h4><div><p>A type-cast representation of the passed value or a Mongo routine configuration.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><a id="union" class="tsd-anchor"></a><h3 class="tsd-anchor-link">union<a href="#union" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><li class="tsd-signature tsd-kind-icon">union<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>query<span class="tsd-signature-symbol">: </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span>, model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span>, unionWith<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span>, metadata<span class="tsd-signature-symbol">?: </span><a href="../modules.html#MongoRoutineCount" class="tsd-signature-type" data-tsd-kind="Type alias">MongoRoutineCount</a><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="PaginatedResultDTO.html" class="tsd-signature-type" data-tsd-kind="Class">PaginatedResultDTO</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L391">src/common/services/QueryService.ts:391</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Create a generic <em>union search query</em> that is compatible with Mongo. The
returned {@link PaginatedResultDto} contains a <code>data</code> field and a
<code>pagination</code> field to permit multiple queries to be sequenced.
<br /><br />
This method also <em>executes</em> the search query using the Mongo service
connected to handle {@param model}.
<br /><br />
This method is different <a href="QueryService.html#find">find</a> in that it permits to execute a
<strong>union query</strong>, effectively <em>combining multiple collections</em> in the
result set.
<br /><br />
Note that this method takes <em>three generics</em> that <strong>must</strong>
extend the <a href="Documentable.html">Documentable</a> class and <strong>must</strong> also
contain a <code>collectionName</code>, e.g. in <a href="Account.html">Account</a>. Only
the <em>first</em> of these generics is <em>obligatory</em>, others can
be used when handling more complex union queries and by default
may be omitted.</p>
</div><dl class="tsd-comment-tags"><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-type-parameters-title">Type Parameters</h4><ul class="tsd-type-parameters"><li><h4>T2ndDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-symbol">{ </span>collectionName<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span></h4></li><li><h4>T3rdDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-symbol">{ </span>collectionName<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span> = <span class="tsd-signature-type">any</span></h4></li><li><h4>T4thDocument<span class="tsd-signature-symbol"> extends </span><a href="Documentable.html" class="tsd-signature-type" data-tsd-kind="Class">Documentable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-symbol">{ </span>collectionName<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span> = <span class="tsd-signature-type">any</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>query: <a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The query configuration with <code>sort</code>, <code>order</code>, <code>pageNumber</code>, <code>pageSize</code>.</p>
</div></div></li><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for the resulting document.</p>
</div></div></li><li><h5>unionWith: <span class="tsd-signature-type">Map</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="Queryable.html" class="tsd-signature-type" data-tsd-kind="Class">Queryable</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>(Optional) This parameter should contain a map of <a href="Queryable.html">Queryable</a> objects - defaults to empty union specification (no union).</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> metadata: <a href="../modules.html#MongoRoutineCount" class="tsd-signature-type" data-tsd-kind="Type alias">MongoRoutineCount</a><span class="tsd-signature-symbol">[]</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>(Optional) This parameter should contain one or more <code>$count</code> pipeline stage(s) - defaults to empty metadata.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="PaginatedResultDTO.html" class="tsd-signature-type" data-tsd-kind="Class">PaginatedResultDTO</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T2ndDocument</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T3rdDocument</span><span class="tsd-signature-symbol"> &amp; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T4thDocument</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The resulting <em>aggregate search query</em> specification that is compatible with <em>Mongo aggregate queries</em>.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="updateBatch" class="tsd-anchor"></a><h3 class="tsd-anchor-link">update<wbr/>Batch<a href="#updateBatch" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">update<wbr/>Batch<span class="tsd-signature-symbol">(</span>model<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span>, documents<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/dhealthproject/dapps-framework/blob/1d7211e/runtime/backend/src/common/services/QueryService.ts#L328">src/common/services/QueryService.ts:328</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Method to update a batch of documents in one collection. The
query built here uses a document&#39;s <code>_id</code> field value and
updates <em>all</em> fields present in the <code>TDocument</code> generic class.
<br /><br />
Note that the <a href="Documentable.html">Documentable</a> concern is used as a
requirement of <code>TDocument</code> to make sure that the <code>_id</code> field
is indeed present and populated.
<br /><br />
Note also that this method automatically sets the value of
a field <code>updatedAt</code> to the time of execution of the query.</p>
</div><dl class="tsd-comment-tags"><dt>todo</dt><dd><p>Currently the <code>$set</code> parameters use <code>new Date()</code>, probably a mongo/mongoose routine for &quot;now&quot; is more adequate.</p>
</dd><dt>access</dt><dd><p>public</p>
</dd><dt>async</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>model: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TModel</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The model <em>class instance</em> used for the resulting document.</p>
</div></div></li><li><h5>documents: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TDocument</span><span class="tsd-signature-symbol">[]</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The list of <em>matching documents</em> that must be updated with this batch operation.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The number of documents <strong>affected</strong> by the update queries.</p>
</div></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="current tsd-kind-class tsd-has-type-parameter"><a href="QueryService.html" class="tsd-kind-icon">Query<wbr/>Service</a><ul><li class="tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter"><a href="QueryService.html#constructor" class="tsd-kind-icon">constructor</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#aggregate" class="tsd-kind-icon">aggregate</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#count" class="tsd-kind-icon">count</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#createOrUpdate" class="tsd-kind-icon">create<wbr/>Or<wbr/>Update</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#exists" class="tsd-kind-icon">exists</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#find" class="tsd-kind-icon">find</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#findOne" class="tsd-kind-icon">find<wbr/>One</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#findWithTotal" class="tsd-kind-icon">find<wbr/>With<wbr/>Total</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><a href="QueryService.html#getAggregateFindQuery" class="tsd-kind-icon">get<wbr/>Aggregate<wbr/>Find<wbr/>Query</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-protected"><a href="QueryService.html#getQueryConfig" class="tsd-kind-icon">get<wbr/>Query<wbr/>Config</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><a href="QueryService.html#sanitizeSearchQuery" class="tsd-kind-icon">sanitize<wbr/>Search<wbr/>Query</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><a href="QueryService.html#typecastField" class="tsd-kind-icon">typecast<wbr/>Field</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><a href="QueryService.html#union" class="tsd-kind-icon">union</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="QueryService.html#updateBatch" class="tsd-kind-icon">update<wbr/>Batch</a></li></ul></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>